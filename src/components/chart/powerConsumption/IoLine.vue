<template>
  <div :id="id" :style="{ width: width, height: height }"></div>
</template>
<script>
import { onMounted, nextTick, onBeforeUnmount, inject } from "vue";
export default {
  props: {
    id: {
      type: String,
      default: "ioLine",
    },
    height: {
      type: String,
      default: "500px",
    },
    name: {
      type: Array,
      default() {
        return ["读取字节数", "写入字节数"];
      },
    },
    width: {
      type: String,
      default: "100%",
    },
    color: {
      type: Array,
      default() {
        return ["rgb(253,74,132)", "rgb(107,189,204)"];
      },
    },
  },
  setup(props) {
    let echarts = inject("ec");
    let myChart;
    // prettier-ignore
    let timeData = [
    "2009/6/12 2:00", 
    "2009/6/12 3:00", 
    "2009/6/12 4:00", 
    "2009/6/12 5:00", 
    "2009/6/12 6:00", 
    "2009/6/12 7:00", 
    "2009/6/12 8:00", 
    "2009/6/12 9:00", 
    "2009/6/12 10:00", 
    "2009/6/12 11:00", 
    "2009/6/12 12:00", 
    "2009/6/12 13:00", 
    "2009/6/12 14:00", 
    "2009/6/12 15:00", 
    "2009/6/12 16:00", 
    "2009/6/12 17:00", 
    "2009/6/12 18:00", 
    "2009/6/12 19:00", 
    "2009/6/12 20:00", 
    "2009/6/12 21:00", 
    "2009/6/12 22:00", 
    "2009/6/12 23:00", 
    "2009/6/13 0:00", 
    "2009/6/13 1:00", 
    "2009/6/13 2:00", 
    "2009/6/13 3:00", 
    "2009/6/13 4:00", 
    "2009/6/13 5:00", 
    "2009/6/13 6:00", 
    "2009/6/13 7:00", 
    "2009/6/13 8:00", 
    "2009/6/13 9:00", 
    "2009/6/13 10:00", 
    "2009/6/13 11:00", 
    "2009/6/13 12:00", 
    "2009/6/13 13:00", 
    "2009/6/13 14:00", 
    "2009/6/13 15:00", 
    "2009/6/13 16:00", 
    "2009/6/13 17:00", 
    "2009/6/13 18:00", 
    "2009/6/13 19:00", 
    "2009/6/13 20:00", 
    "2009/6/13 21:00", 
    "2009/6/13 22:00", 
    "2009/6/13 23:00", 
    "2009/6/14 0:00", 
    "2009/6/14 1:00", 
    "2009/6/14 2:00", 
    "2009/6/14 3:00", 
    "2009/6/14 4:00", 
    "2009/6/14 5:00", 
    "2009/6/14 6:00", 
    "2009/6/14 7:00", 
    "2009/6/14 8:00", 
    "2009/6/14 9:00", 
    "2009/6/14 10:00", 
    "2009/6/14 11:00", 
    "2009/6/14 12:00", 
    "2009/6/14 13:00", 
    "2009/6/14 14:00", 
    "2009/6/14 15:00", 
    "2009/6/14 16:00", 
    "2009/6/14 17:00", 
    "2009/6/14 18:00", 
    "2009/6/14 19:00", 
    "2009/6/14 20:00", 
    "2009/6/14 21:00", 
    "2009/6/14 22:00", 
    "2009/6/14 23:00", 
    "2009/6/15 0:00", 
    "2009/6/15 1:00", 
    "2009/6/15 2:00", 
    "2009/6/15 3:00", 
    "2009/6/15 4:00", 
    "2009/6/15 5:00", 
    "2009/6/15 6:00", 
    "2009/6/15 7:00", 
    "2009/6/15 8:00", 
    "2009/6/15 9:00", 
    "2009/6/15 10:00", 
    "2009/6/15 11:00", 
    "2009/6/15 12:00", 
    "2009/6/15 13:00", 
    "2009/6/15 14:00", 
    "2009/6/15 15:00", 
    "2009/6/15 16:00", 
    "2009/6/15 17:00", 
    "2009/6/15 18:00", 
    "2009/6/15 19:00", 
    "2009/6/15 20:00", 
    "2009/6/15 21:00", 
    "2009/6/15 22:00", 
    "2009/6/15 23:00", 
    "2009/6/15 0:00", 
    "2009/6/16 1:00", 
    "2009/6/16 2:00", 
    "2009/6/16 3:00", 
    "2009/6/16 4:00", 
    "2009/6/16 5:00", 
    "2009/6/16 6:00", 
    "2009/6/16 7:00", 
    "2009/6/16 8:00", 
    "2009/6/16 9:00", 
    "2009/6/16 10:00", 
    "2009/6/16 11:00", 
    "2009/6/16 12:00", 
    "2009/6/16 13:00", 
    "2009/6/16 14:00", 
    "2009/6/16 15:00", 
    "2009/6/16 16:00", 
    "2009/6/16 17:00", 
    "2009/6/16 18:00", 
    "2009/6/16 19:00", 
    "2009/6/16 20:00", 
    "2009/6/16 21:00", 
    "2009/6/16 22:00", 
    "2009/6/16 23:00", 
    "2009/6/15 0:00", 
    "2009/6/17 1:00", 
    "2009/6/17 2:00", 
    "2009/6/17 3:00", 
    "2009/6/17 4:00", 
    "2009/6/17 5:00", 
    "2009/6/17 6:00", 
    "2009/6/17 7:00", 
    "2009/6/17 8:00", 
    "2009/6/17 9:00", 
    "2009/6/17 10:00", 
    "2009/6/17 11:00", 
    "2009/6/17 12:00", 
    "2009/6/17 13:00", 
    "2009/6/17 14:00", 
    "2009/6/17 15:00", 
    "2009/6/17 16:00", 
    "2009/6/17 17:00", 
    "2009/6/17 18:00", 
    "2009/6/17 19:00", 
    "2009/6/17 20:00", 
    "2009/6/17 21:00", 
    "2009/6/17 22:00", 
    "2009/6/17 23:00", 
    "2009/6/18 0:00", 
    "2009/6/18 1:00", 
    "2009/6/18 2:00", 
    "2009/6/18 3:00", 
    "2009/6/18 4:00", 
    "2009/6/18 5:00", 
    "2009/6/18 6:00", 
    "2009/6/18 7:00", 
    "2009/6/18 8:00", 
    "2009/6/18 9:00", 
    "2009/6/18 10:00", 
    "2009/6/18 11:00", 
    "2009/6/18 12:00", 
    "2009/6/18 13:00", 
    "2009/6/18 14:00", 
    "2009/6/18 15:00", 
    "2009/6/18 16:00", 
    "2009/6/18 17:00", 
    "2009/6/18 18:00", 
    "2009/6/18 19:00", 
    "2009/6/18 20:00", 
    "2009/6/18 21:00", 
    "2009/6/18 22:00", 
    "2009/6/18 23:00"];
    timeData = timeData.map(function (str) {
      return str.replace("2009/", "");
    });
    const options = {
      //   title: {
      //     text: "百分比",
      //     textStyle: {
      //       fontWeight: "normal",
      //       fontSize: 12,
      //       lineHeight: 20,
      //       height: 20,
      //     },
      //     left: 10,
      //   },
      color: props.color,
      tooltip: {
        trigger: "axis",
        axisPointer: {
          animation: false,
        },
      },
      legend: {
        data: props.name,
        left: "center",
      },
      toolbox: {
        show: false,
        feature: {
          dataZoom: {
            yAxisIndex: "none",
          },
          restore: {},
          saveAsImage: {},
        },
      },
      axisPointer: {
        link: [
          {
            xAxisIndex: "all",
          },
        ],
      },
      dataZoom: [
        {
          show: true,
          realtime: true,
          // start: 30,
          // end: 70,
          xAxisIndex: [0, 1],
          type: "slider",
          startValue: 0,
          handleIcon:
            "path://M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4v1.3h1.3v-1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z",
          handleSize: "100%",
          handleStyle: {
            color: "#0B3C6F",
            shadowBlur: 3,
            shadowColor: "rgba(0, 0, 0, 0.6)",
            shadowOffsetX: 2,
            shadowOffsetY: 2,
          },
          bottom: "10px",
          right: 20,
          left: 50,
        },
      ],
      grid: [
        {
          left: 30,
          right: 0,
          top: 30,
        },
      ],
      xAxis: [
        {
          type: "category",
          boundaryGap: false,
          axisLine: { onZero: true },
          data: timeData,
        },
      ],
      yAxis: [
        {
          name: "单位: KB/S",
          type: "value",
        },
      ],
      series: [
        {
          name: props.name[0],
          type: "line",
          showSymbol: false,
          data: [
            0.026, 0.03, 0.036, 0.036, 0.195, 0.221, 0.019, 0.013, 0.017, 0.03,
            0.03, 0.03, 0.046, 0.045, 0.038, 0.084, 0.045, 0.045, 0.037, 0.034,
            0.035, 0.036, 0.044, 0.052, 0.048, 0.109, 0.033, 0.029, 0.04, 0.042,
            0.042, 0.042, 0.073, 0.076, 0.062, 0.066, 0.066, 0.075, 0.096,
            0.128, 0.121, 0.128, 0.14, 0.226, 0.143, 0.097, 0.018, 0, 0, 0, 0,
            0, 0.018, 0.047, 0.054, 0.054, 0.054, 0.036, 0.185, 0.009, 0.038,
            0.061, 0.077, 0.091, 0.126, 0.69, 0.182, 0.349, 0.231, 0.146, 0.128,
            0.167, 0.1, 0.075, 0.071, 0.071, 0.117, 0.01, 0.002, 0.002, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          ],
        },
        {
          name: props.name[1],
          type: "line",
          showSymbol: false,
          data: [
            0.006, 0.003, 0.016, 0.016, 0.095, 0.021, 0.019, 0.013, 0.017, 0.03,
            0.03, 0.03, 0.046, 0.045, 0.038, 0.084, 0.045, 0.045, 0.037, 0.034,
            0.035, 0.036, 0.044, 0.052, 0.048, 0.109, 0.033, 0.029, 0.3, 0.042,
            0.042, 0.042, 0.073, 0.076, 0.062, 0.066, 0.066, 0.075, 0.096,
            0.128, 0.121, 0.128, 0.14, 0.226, 0.143, 0.097, 0.018, 0, 0, 0, 0,
            0, 0.018, 0.047, 0.054, 0.054, 0.054, 0.036, 0.185, 0.009, 0.038,
            0.061, 0.077, 0.091, 0.126, 0.69, 0.182, 0.349, 0.231, 0.146, 0.128,
            0.167, 0.1, 0.075, 0.071, 0.071, 0.117, 0.01, 0.002, 0.002, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
          ],
        },
      ],
    };
    onMounted(() => {
      nextTick(() => {
        //需要获取到element,所以是onMounted的Hook
        myChart = echarts.init(document.getElementById(props.id));
        // 绘制图表
        // 折线散点图
        myChart.setOption(options);
      });
      window.onresize = function () {
        //自适应大小
        myChart.resize();
      };
    });
    onBeforeUnmount(() => {
      myChart = null;
      window.onresize = null;
    });
    return {};
  },
};
</script>
<style lang="scss" scoped></style>
